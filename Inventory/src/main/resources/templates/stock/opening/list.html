<div class="row">
	<div class="col-lg-12">
		
		<br/>
		<div class="clearfix"></div>
		<div class="row">
		<!-- Create Button -->
			<button type="button" class="btn btn-success pull-right"
			data-toggle="modal" data-target="#formModal" id="createButton" data-backdrop="static"
			data-keyboard="false">Add Adjustment</button>	
		<!-- /Create Button -->
		</div>
		
		<div class="panel panel-default">
			<div class="panel-body">
				<table class="table table-striped table-bordered table-hover"
					id="openingStock-datatable" style="width:100%">
					<thead>
						<tr>
							<th width="100px">System #</th>
							<th width="120px">Document #</th>
							<th>Date</th>
							<th>Location</th>
							<th class="col-md-2">Action</th>
						</tr>
					</thead>
					
				</table>
				<!-- /.table-responsive -->
			</div>
			<!-- /.panel-body -->
		</div>
	</div>
</div>


<div class="modal fade" id="formModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<form data-async data-target="#rating-modal" id="createStockTransferForm" th:object="${stockOpeningForm}" th:action="@{/api/openingstock}" method="POST">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					<h4 class="modal-title" id="modalLabel">Add Adjustment</h4>
				</div>

				<div class="panel-body">
				
					<div class="form-group" id="errors"></div>
					
					<div class="form-group">
						<label>Year</label>
						<input type="number" class="form-control" th:field="*{year}" maxlength="30">
					</div>
					
					<div class="form-group">
						<label>Document Number</label>
						<input type="text" class="form-control" th:field="*{document_number}" maxlength="30">
					</div>
					
					<div class="form-group">
						<label>Description</label> 
						<input type="text" class="form-control" th:field="*{description}" maxlength="225">
						</select>
					</div>
					
					<div class="form-group">
						<label>Location</label> 
						<select class="form-control" th:field="*{location}" style="width: 100%;">
						</select>
					</div>				
					
				</div>

				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
					<button type="submit" id="submit" class="btn btn-success btn-primary">Create</button>
				</div>
			</form>
		</div>
		<!-- /.modal-content -->
	</div>
	<!-- /.modal-dialog -->
</div>
	

<!-- DataTables JavaScript -->
<script
	th:src="@{/static/vendor/datatables/js/jquery.dataTables.min.js}"></script>
<script
	th:src="@{/static/vendor/datatables-plugins/dataTables.bootstrap.min.js}"></script>
<script
	th:src="@{/static/vendor/datatables-responsive/dataTables.responsive.js}"></script>
<script>
	$('.datepicker').datepicker({
	  
	});
	var formModal = $("#formModal");
	var modalLabel = formModal.find("#modalLabel");
	var submitButtonLabel = $("#formModal #submit");
	var form = $("#createStockTransferForm");
	var table = $('#openingStock-datatable');
	var datatable = customFixedDatatable(table, '/api/datatable/openingstock', 
		[
        	{ data: "system_number" },
        	{ data: "document_number" },
        	{ data: "transaction_date" },
        	{ data: "location_name" },
    	],
    	[ 
    		{
                "targets": 4,
                "data": null,
                "defaultContent":
                	'<div class="btn-group" role="group">'
                	+ '<button class="btn btn-default glyphicon glyphicon-eye-open" id="btnView"/>'
                	+ '<button class="btn btn-primary glyphicon glyphicon-pencil" /> '
                	+ '<button class="btn btn-danger glyphicon glyphicon-remove" /> '
                	+ '</div>'
            }
    		
    	]
	);
	
	$("#createButton").on('click', function (e) {
		form[0].reset();
		form.attr("method", "POST"); // change to POST when editing
		form.find('#id').val("");
		modalLabel.text("Adjustment Stock");
		submitButtonLabel.text("Adjustment");

/* 		singledatetimepicker($("input#transaction_date"))
		$("input#transaction_date").val(moment(new Date()).format("YYYY-MM-DD HH:mm:ss")) */
		
		$('#location').val(" "); // reset select2 dropdown
		loadLocationData();
	});
	
	formModalAsync($("#formModal"), function() {
		datatable.ajax.reload( null, false ); // user paging is not reset on reload
	});
	
	function loadLocationData(){
		$('#location').select2({
	  		ajax: {
		    	url: '/api/sales/locations',
		    	dataType: 'json',
		    	delay: 250
		 	}
		});
	}
	
</script>